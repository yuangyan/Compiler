<html>
    <body>
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>
            mermaid.initialize({ startOnLoad: true, maxTextSize: 600000 });
        </script>

        NFA2DFA:
        <div class="mermaid"> 
            graph TD
            id1["C=new list()<br>E=new list()<br>DFA=new dict()"]
            id2["C.append(ε-closure(K0))<br>E.append(ε-closure(K0))"]
            id1-->id2
            id3{"C.isempty()"}
            id2-->id3
            id4["end"]
            id3--true-->id4
            id5["S=C.pop(), i=0"]
            id3--false-->id5
            id6{"i != len(edges)"}
            id5-->id6
            id7["S'=ε-closure(moveto(S', edges[i]))<br>DFA[(S, edges[i])] = S'"]
            id6--true-->id7
            id6--false-->id3
            id8{"S' in E"}
            id7-->id8
            id9["C.append(S')<br>E.append(S')"]
            id8--false-->id9
            id8--true-->id6
            id9-->id6
        </div>
        ε-closure:
        <div class="mermaid"> 
            graph TD
            id1["closure=set(S)<br>i=0<br>S'=S.copy()"]
            id2{"i != len(S')"}
            id1-->id2
            id3["S'' = NFA[(S'.pop(), ε)]"]
            id2--false-->id4[end]
            id2--true-->id3
            id5{"S'' in S"}
            id3-->id5
            id5--true-->id2
            id6["closure.add(S'')<br>S'.append(S'')"]
            id5--false-->id6
        </div>
        Parse:
        <div class="mermaid">
            graph TD
            id0[stat=0]
            
            id1{"s.isempty()"}
            id2[end]
            id3["nextstat=DFA[stat, s[0]]"]
            id0-->id3
            id4{"nextstat == None"}
            id3-->id4
            id4--true-->id5["return error"]
            id5-->id2
            id4--false-->id1
            id1--false-->id6["s=s[1:]<br>stat=nextstat"]
            id6-->id3
            id1--true-->id7{"nextstat in VT"}
            id7--true-->id8["return type[nextstat]"]-->id2
            id7--false-->id5
        </div>


        total
        <div class="mermaid">
            graph TD
            subgraph 输入文件预处理
                id1["读取输入文件<br>读取正规式规则"]-->id2["建立待分析队列<br>存储关键字等固定规则<br>存储NFA规则"]
                id2-->id5["NFA转为DFA"]
                
            end
            subgraph 分析阶段
                id3{"待分析队列为空"}
                id5-->id3
                
                id3--false-->id6["取出队首s"]
                id6-->id7{"判断是否为关键词，<br>限定符和操作符"}
                id7--true-->id8["输出缓冲写入行号，类型，内容"]
                id8-->id3
                id7--false-->id9["送入DFA分析"]
                id9-->id10["分析结果写入输出缓冲"]
                id10-->id3
            end
            subgraph 输出阶段
                id3--true-->id0[写输出文件]
                id0-->id4["结束"]
            end
           

        </div>

        canbevoid
        <div class="mermaid">
            graph TD
            id1["canbevoid=dict()<br>canbevoid[:]=false"]

        </div>

    </body>
</html>